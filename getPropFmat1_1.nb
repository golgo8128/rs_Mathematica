getPropFmat[idm_] := Module[ 
  {Imt, Wmt},
  Imt = IdentityMatrix[idm];
  Wmt = 1/2*(RotateLeft[Imt] + RotateRight[Imt]);
  Factor[Inverse[Imt - a*Wmt]*(1 - a)]
  ]
  
  
  
  
tmp1={0,0,0,0,0}
tmp1[[{1,2,5}]]=1
(1+#)&/@Subsets[Range[5],{3}]




In[21]:= turnOnNums[ilt_, lng_] := Module [
{ zrs },
zrs=PadLeft[{0}, lng];
zrs[[ilt]] = 1;
zrs
]
In[23]:= turnOnNums[{1,3,4}]

Out[23]= {1,0,1,1,0}
In[24]:= (turnOnNums[#,5])&/@Subsets[Range[5],{3}]
Out[24]= {{1,1,1,0,0},{1,1,0,1,0},{1,1,0,0,1},{1,0,1,1,0},{1,0,1,0,1},{1,0,0,1,1},{0,1,1,1,0},{0,1,1,0,1},{0,1,0,1,1},{0,0,1,1,1}}


In[25]:= getPropFmat[5]
Out[25]= {{(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2)},{((-2+a) a)/(-4-2 a+a^2),(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2))},{-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2),(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2))},{-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2),(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2)},{((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2),(-4+2 a+a^2)/(-4-2 a+a^2)}}

In[26]:= {(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2)} * (turnOnNums[#,5])&/@Subsets[Range[5],{3}]
Out[26]= {{(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),0,0},{(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),0,-(a^2/(-4-2 a+a^2)),0},{(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),0,0,((-2+a) a)/(-4-2 a+a^2)},{(-4+2 a+a^2)/(-4-2 a+a^2),0,-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),0},{(-4+2 a+a^2)/(-4-2 a+a^2),0,-(a^2/(-4-2 a+a^2)),0,((-2+a) a)/(-4-2 a+a^2)},{(-4+2 a+a^2)/(-4-2 a+a^2),0,0,-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2)},{0,((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),0},{0,((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),0,((-2+a) a)/(-4-2 a+a^2)},{0,((-2+a) a)/(-4-2 a+a^2),0,-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2)},{0,0,-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2)}}
In[29]:= Total[{(-4+2 a+a^2)/(-4-2 a+a^2),((-2+a) a)/(-4-2 a+a^2),-(a^2/(-4-2 a+a^2)),-(a^2/(-4-2 a+a^2)),((-2+a) a)/(-4-2 a+a^2)} * (turnOnNums[#,5])&/@Subsets[Range[5],{3}]]
Out[29]= {(6 (-4+2 a+a^2))/(-4-2 a+a^2),(6 (-2+a) a)/(-4-2 a+a^2),-((6 a^2)/(-4-2 a+a^2)),-((6 a^2)/(-4-2 a+a^2)),(6 (-2+a) a)/(-4-2 a+a^2)}